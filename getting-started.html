<h1 id="getting-started">Getting Started</h1>
<p>These are instuctions for starting a new app with the New Router with AngularJS 1.4.</p>
<p>Include <code>router.es5.js</code> in your app&#39;s <code>index.html</code>.</p>
<h2 id="project-structure">Project Structure</h2>
<p>We&#39;re going to organize our code like this, and assume we have a simple HTTP server
that serves files at a path corresponding to their location within the file system.</p>
<pre><code>index.html
package.json
components/
├── app/
│   ├── app.html
│   └── app.js
├── phone-detail/
│   ├── phone-detail.html
│   └── phone-detail.js
├── phone-list/
│   ├── phone-list.html
│   └── phone-list.js
node_modules/
└── ...
</code></pre><p>Let&#39;s start with the contents of <code>index.html</code>:</p>
<pre><code class="lang-html">&lt;!doctype html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
  &lt;meta charset=&quot;utf-8&quot;&gt;
  &lt;base href=&quot;/&quot;&gt;
  &lt;title&gt;My app&lt;/title&gt;
&lt;/head&gt;
&lt;body ng-app=&quot;myApp&quot;&gt;
  &lt;div router-component=&quot;app&quot;&gt;&lt;/div&gt;

  &lt;script src=&quot;/node_modules/angular/angular.js&quot;&gt;&lt;/script&gt;
  &lt;script src=&quot;/dist/router.es5.js&quot;&gt;&lt;/script&gt;
  &lt;script src=&quot;/app/app.js&quot;&gt;&lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<h2 id="a-component">A component</h2>
<p>You might&#39;ve noticed that we have a directory called <code>components</code>.</p>
<p>In Angular 1, a component is a template and a controller.</p>
<!--
<aside>
In Angular 2, the DI system understands how to... .

In Angular 1, we need this component system to hook up child routers.
</aside>
-->

<p>A component&#39;s template can have view ports.</p>
<p>A component&#39;s controller can have a router.
A component&#39;s router tells the component what to put inside the view ports based on configuration.
The configuration maps routes to components for each viewport.</p>
<p>Let&#39;s see what this looks like:</p>
<p><code>app/app.js</code></p>
<pre><code class="lang-html">angular.module(&#39;PhoneListController&#39;, function (router) {
  router.config([
    {path: &#39;&#39;, component: &#39;detail&#39; }
  ])
});
</code></pre>
<h2 id="nesting-routes">Nesting Routes</h2>
<p>module.controller(&#39;PhoneListController&#39;, function (router) {
  router.config([
    {path: &#39;&#39;, component: &#39;detail&#39; }
  ])
});</p>
<h2 id="lifecycle-hooks">Lifecycle hooks</h2>
<p>There are three main lifecycle hooks: <code>canActivate</code>, <code>activate</code>, and <code>canDeactivate</code>.</p>
<p>To understand how this works, let&#39;s step through a simple case where a component wants to navigate from one route to another.</p>
<h3 id="an-example">An example</h3>
<pre><code class="lang-js">MyController(user, $http) {
  this.user = user;
  this.$http = $http;
  this.userDataPersisted = true;
}

MyController.prototype.updateUserName = function(newName) {
  var self = this;
  this.userDataPersisted = false;
  return this.user.setName(newName).then(function () {
    self.userDataPersisted = true;
  });
};

MyController.prototype.canActivate = function() {
  return this.user.isAdmin;
};

MyController.prototype.activate = function() {
  this.user.downloadBigFiles();
};

MyController.prototype.canDeactivate = function() {
  return this.userDataPersisted;
};
</code></pre>
<h3 id="high-level-overview">High level overview</h3>
<p>This is the basic logic that the router uses.</p>
<pre><code class="lang-dot"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: G Pages: 1 -->
<svg width="406pt" height="448pt"
 viewBox="0.00 0.00 405.71 448.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 444)">
<title>G</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-444 401.708,-444 401.708,4 -4,4"/>
<!-- complete navigation -->
<g id="node1" class="node"><title>complete navigation</title>
<polygon fill="lightgrey" stroke="none" points="363.117,-36 223.069,-36 223.069,-0 363.117,-0 363.117,-36"/>
<text text-anchor="middle" x="293.093" y="-13.8" font-family="Helvetica,sans-Serif" font-size="14.00">complete navigation</text>
</g>
<!-- cancel navigation -->
<g id="node2" class="node"><title>cancel navigation</title>
<polygon fill="lightgrey" stroke="none" points="124.278,-36 -0.0929123,-36 -0.0929123,-0 124.278,-0 124.278,-36"/>
<text text-anchor="middle" x="62.0928" y="-13.8" font-family="Helvetica,sans-Serif" font-size="14.00">cancel navigation</text>
</g>
<!-- begin navigation -->
<g id="node3" class="node"><title>begin navigation</title>
<polygon fill="lightgrey" stroke="none" points="352.064,-440 234.121,-440 234.121,-404 352.064,-404 352.064,-440"/>
<text text-anchor="middle" x="293.093" y="-417.8" font-family="Helvetica,sans-Serif" font-size="14.00">begin navigation</text>
</g>
<!-- oldCtrl.canDeactivate() -->
<g id="node4" class="node"><title>oldCtrl.canDeactivate()</title>
<polygon fill="none" stroke="black" points="397.824,-367 188.361,-367 188.361,-331 397.824,-331 397.824,-367"/>
<text text-anchor="middle" x="293.093" y="-344.8" font-family="Courier,monospace" font-size="14.00">oldCtrl.canDeactivate()</text>
</g>
<!-- begin navigation&#45;&gt;oldCtrl.canDeactivate() -->
<g id="edge1" class="edge"><title>begin navigation&#45;&gt;oldCtrl.canDeactivate()</title>
<path fill="none" stroke="black" d="M293.093,-403.955C293.093,-403.955 293.093,-377.09 293.093,-377.09"/>
<polygon fill="black" stroke="black" points="296.593,-377.09 293.093,-367.09 289.593,-377.09 296.593,-377.09"/>
</g>
<!-- oldCtrl.canDeactivate()&#45;&gt;cancel navigation -->
<g id="edge3" class="edge"><title>oldCtrl.canDeactivate()&#45;&gt;cancel navigation</title>
<path fill="none" stroke="black" d="M192.678,-330.765C192.678,-262.648 192.678,-27 192.678,-27 192.678,-27 134.326,-27 134.326,-27"/>
<polygon fill="black" stroke="black" points="134.326,-23.5001 124.326,-27 134.326,-30.5001 134.326,-23.5001"/>
</g>
<!-- newCtrl = new Ctrl() -->
<g id="node5" class="node"><title>newCtrl = new Ctrl()</title>
<polygon fill="none" stroke="black" points="385.12,-281 201.065,-281 201.065,-245 385.12,-245 385.12,-281"/>
<text text-anchor="middle" x="293.093" y="-258.8" font-family="Courier,monospace" font-size="14.00">newCtrl = new Ctrl()</text>
</g>
<!-- oldCtrl.canDeactivate()&#45;&gt;newCtrl = new Ctrl() -->
<g id="edge2" class="edge"><title>oldCtrl.canDeactivate()&#45;&gt;newCtrl = new Ctrl()</title>
<path fill="none" stroke="black" d="M293.093,-330.762C293.093,-330.762 293.093,-291.212 293.093,-291.212"/>
<polygon fill="black" stroke="black" points="296.593,-291.212 293.093,-281.212 289.593,-291.212 296.593,-291.212"/>
<text text-anchor="middle" x="303.976" y="-301.8" font-family="Times,serif" font-size="14.00" fill="darkgreen">true</text>
</g>
<!-- newCtrl = new Ctrl()&#45;&gt;cancel navigation -->
<g id="edge5" class="edge"><title>newCtrl = new Ctrl()&#45;&gt;cancel navigation</title>
<path fill="none" stroke="black" d="M200.8,-263C136.457,-263 62.0928,-263 62.0928,-263 62.0928,-263 62.0928,-46.0154 62.0928,-46.0154"/>
<polygon fill="black" stroke="black" points="65.5929,-46.0154 62.0928,-36.0154 58.5929,-46.0155 65.5929,-46.0154"/>
</g>
<!-- newCtrl.canActivate() -->
<g id="node6" class="node"><title>newCtrl.canActivate()</title>
<polygon fill="none" stroke="black" points="389.522,-195 196.664,-195 196.664,-159 389.522,-159 389.522,-195"/>
<text text-anchor="middle" x="293.093" y="-172.8" font-family="Courier,monospace" font-size="14.00">newCtrl.canActivate()</text>
</g>
<!-- newCtrl = new Ctrl()&#45;&gt;newCtrl.canActivate() -->
<g id="edge4" class="edge"><title>newCtrl = new Ctrl()&#45;&gt;newCtrl.canActivate()</title>
<path fill="none" stroke="black" d="M293.093,-244.762C293.093,-244.762 293.093,-205.212 293.093,-205.212"/>
<polygon fill="black" stroke="black" points="296.593,-205.212 293.093,-195.212 289.593,-205.212 296.593,-205.212"/>
<text text-anchor="middle" x="300.093" y="-215.8" font-family="Times,serif" font-size="14.00" fill="darkgreen">ok</text>
</g>
<!-- newCtrl.canActivate()&#45;&gt;cancel navigation -->
<g id="edge7" class="edge"><title>newCtrl.canActivate()&#45;&gt;cancel navigation</title>
<path fill="none" stroke="black" d="M203.179,-158.761C203.179,-116.997 203.179,-18 203.179,-18 203.179,-18 134.386,-18 134.386,-18"/>
<polygon fill="black" stroke="black" points="134.386,-14.5001 124.386,-18 134.386,-21.5001 134.386,-14.5001"/>
</g>
<!-- newCtrl.activate() -->
<g id="node7" class="node"><title>newCtrl.activate()</title>
<polygon fill="none" stroke="black" points="376.818,-109 209.368,-109 209.368,-73 376.818,-73 376.818,-109"/>
<text text-anchor="middle" x="293.093" y="-86.8" font-family="Courier,monospace" font-size="14.00">newCtrl.activate()</text>
</g>
<!-- newCtrl.canActivate()&#45;&gt;newCtrl.activate() -->
<g id="edge6" class="edge"><title>newCtrl.canActivate()&#45;&gt;newCtrl.activate()</title>
<path fill="none" stroke="black" d="M293.093,-158.762C293.093,-158.762 293.093,-119.212 293.093,-119.212"/>
<polygon fill="black" stroke="black" points="296.593,-119.212 293.093,-109.212 289.593,-119.212 296.593,-119.212"/>
<text text-anchor="middle" x="303.976" y="-129.8" font-family="Times,serif" font-size="14.00" fill="darkgreen">true</text>
</g>
<!-- newCtrl.activate()&#45;&gt;complete navigation -->
<g id="edge8" class="edge"><title>newCtrl.activate()&#45;&gt;complete navigation</title>
<path fill="none" stroke="black" d="M293.093,-72.9551C293.093,-72.9551 293.093,-46.0904 293.093,-46.0904"/>
<polygon fill="black" stroke="black" points="296.593,-46.0903 293.093,-36.0904 289.593,-46.0904 296.593,-46.0903"/>
</g>
<!-- newCtrl.activate()&#45;&gt;cancel navigation -->
<g id="edge9" class="edge"><title>newCtrl.activate()&#45;&gt;cancel navigation</title>
<path fill="none" stroke="black" d="M216.156,-72.8015C216.156,-48.6437 216.156,-9 216.156,-9 216.156,-9 134.312,-9 134.312,-9"/>
<polygon fill="black" stroke="black" points="134.312,-5.5001 124.312,-9 134.312,-12.5001 134.312,-5.5001"/>
</g>
</g>
</svg>

</code></pre>
<!--
TODO: show multi-level
-->


<h3 id="handling-failure">Handling failure</h3>
<p>What happens when a <code>canActivate</code> or <code>canDeactivate</code> returns <code>false</code>?</p>
<p>By default, this stops the navigation entirely.</p>
<p><!--
TODO: show multiple levels
TODO:
-->
i</p>
<h2 id="multiple-viewports">Multiple Viewports</h2>
<p>A component can have multiple viewports:</p>
<p><code>multiview.html</code></p>
<pre><code class="lang-html">&lt;div class=&quot;container&quot;&gt;
  &lt;div ng-view-port=&quot;left&quot;&gt;&lt;/div&gt;
  &lt;div ng-view-port=&quot;right&quot;&gt;&lt;/div&gt;
&lt;/div&gt;
</code></pre>
<p>Viewports are named with the <code>ng-view-port</code> attribute.</p>
<p>They are then configured like this:</p>
<p><code>multiview.js</code></p>
<pre><code class="lang-js">router.config([
  { path: &#39;/&#39;, components: { left: &#39;tree&#39;, right: &#39;detail&#39; } }
])
</code></pre>
<h2 id="additional-reading">Additional reading</h2>
<p>See the <code>examples/</code> directory for common recipies.</p>
